#include <windows.h>
#include <stdio.h>

void SendText(const char* text) {
    INPUT inputs[256] = { 0 };
    int i = 0;

    while (*text) {
        inputs[i].type = INPUT_KEYBOARD;
        inputs[i].ki.wVk = 0;
        inputs[i].ki.wScan = *text;
        inputs[i].ki.dwFlags = KEYEVENTF_UNICODE;
        i++;
        text++;
    }

    SendInput(i, inputs, sizeof(INPUT));
}

int main(void) {
    
DWORD pid = 10628; // Reemplaza 1234 con el PID del Bloc de notas obtenido en el primer programa
HWND hWnd;
HANDLE hProcess;

    // Abrir el proceso existente usando su PID
    hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);
    if (hProcess == NULL) {
        printf("(-) Error al abrir el proceso. Código de error: %ld\n", GetLastError());
        return EXIT_FAILURE;
    }

    // Buscar la ventana principal del Bloc de notas
    hWnd = FindWindowW(NULL, L"Untitled - Notepad");  // Ajusta el título según el idioma del sistema
    if (hWnd == NULL) {
        printf("(-) No se pudo encontrar la ventana del Bloc de notas.\n");
        CloseHandle(hProcess);
        return EXIT_FAILURE;
    }

    // Traer la ventana al frente y enfocarla
    SetForegroundWindow(hWnd);
    SetFocus(hWnd);

    // Enviar texto al Bloc de notas usando SendInput
    SendText("Entro en tu notepad <3");

    printf("(+) Texto enviado al Bloc de notas.\n");

    // Cerrar el handle del proceso
    CloseHandle(hProcess);

    return EXIT_SUCCESS;
}
